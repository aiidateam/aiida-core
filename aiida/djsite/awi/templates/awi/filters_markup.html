{% extends 'awi/base_ajax.html' %}
{% load awi_tags %}

{% block ajax %}
{% for fieldname, f in filters.items|sort %}
	<div class="btn-group btn-group-sm" id="filter-{{ fieldname }}">
		<button type="button" class="btn btn-warning filter-field disabled"><strong>{{ f.display_name }}</strong></button>
		<div class="btn-group btn-group-sm">
			{% if f.type != 'list' and f.type != 'boolean' %}
				<button type="button" class="btn btn-default dropdown-toggle filter-operator" data-toggle="dropdown"></button>
				<ul class="dropdown-menu filter-operators"></ul>
			{% else %}
				<button type="button" class="btn btn-default filter-operator disabled"></button>
			{% endif %}
		</div>
		{% if f.type != 'list' and f.type != 'boolean' %}
			{% if f.value != '' %}
				<button type="button" class="btn btn-default filter-value" data-toggle="modal" data-target="#filter-modal" href="{% url 'awi:filters_value' module=module field=fieldname %}">{{ f.value }}</button>
			{% else %}
				{% if f.operator == 'isnull' %}
					<button type="button" class="btn btn-default filter-value disabled" data-toggle="modal" data-target="#filter-modal" href="{% url 'awi:filters_value' module=module field=fieldname %}"><em>is null</em></button>
				{% else %}
					<button type="button" class="btn btn-default filter-value" data-toggle="modal" data-target="#filter-modal" href="{% url 'awi:filters_value' module=module field=fieldname %}">&nbsp;</button>
				{% endif %}
			{% endif %}
		{% else %}
			<div class="btn-group btn-group-sm">
				{% if f.type == 'list' %}
					<button type="button" class="btn btn-default dropdown-toggle filter-value filter-list" data-toggle="dropdown">{{ f.value }}</button>
				{% else %}
					{% if f.value == 'true' %}
						<button type="button" class="btn btn-default dropdown-toggle filter-value filter-list text-success" data-toggle="dropdown">{{ f.value }}</button>
					{% else %}
						<button type="button" class="btn btn-default dropdown-toggle filter-value filter-list text-danger" data-toggle="dropdown">{{ f.value }}</button>
					{% endif %}
				{% endif %}
				<ul class="dropdown-menu filter-values"></ul>
			</div>
		{% endif %}
		<button type="button" class="btn btn-default text-danger filter-remove" data-field="{{ fieldname }}"><strong>&times;</strong></button>
	</div>
{% endfor %}
<script>
	var filters = [];
	{% for fieldname, f in filters.items|sort %}
		filters.push({field: '{{ fieldname }}', type: '{{ f.type }}', operator: '{{ f.operator }}'});
	{% endfor %}
	am.filtersManager.loadFilters(filters);
</script>
{% endblock %}