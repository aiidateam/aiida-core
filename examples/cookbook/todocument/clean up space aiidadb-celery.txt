# The celery-taskmeta table grows over time because it stores
# the result of each completed task.
# To clean it up with postgresql, and reduce space:

in 'verdi shell':

from djcelery.models import TaskMeta, states
TaskMeta.objects.filter(status=states.SUCCESS).delete()



in 'psql -U postgres -W -h localhost':

SELECT pg_size_pretty(pg_database_size('aiidadb'));
\c aiidadb

VACUUM;
REINDEX TABLE celery_taskmeta;

SELECT pg_size_pretty(pg_database_size('aiidadb'));
